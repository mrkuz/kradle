plugins {
    id("org.jetbrains.kotlin.jvm") version "${versions.kotlin}"
    id("net.bitsandbobs.kradle") version "${kradleVersion}"
}

group = "com.example"
version = "1.0.0"

kradle {

    general {
        bootstrap.enable()
        git.enable()
        projectProperties.enable()
        buildProperties.enable()
    }

    jvm {
        application {
            mainClass("com.example.demo.AppKt")
        }

        // targetJvm("${versions.jvm}")
        kotlin {
            useCoroutines(/* "${versions.kotlinCoroutines}" */)
            lint {
                ktlint {
                    // version("${versions.ktlint}")
                    rules {
                        disable("no-wildcard-imports")
                    }
                }
            }
            codeAnalysis {
                detekt {
                    // version("${versions.detekt}")
                    // configFile("detekt-config.yml")
                }
            }
            test {
                useKotest(/* "${versions.kotest}" */)
                useMockk(/* "${versions.mockk}" */)
            }
        }
        java {
            // withPreviewFeatures(true)
            lint {
                checkstyle {
                    // version("${versions.checkstyle}")
                    // configFile("checkstyle.xml")
                }
            }
            codeAnalysis {
                pmd {
                    // version("${versions.pmd}")
                    ruleSets {
                        // bestPractices(false)
                        // codeStyle(false)
                        // design(false)
                        // documentation(false)
                        // errorProne(true)
                        // multithreading(true)
                        // performance(true)
                        // security(true)
                    }
                }
                spotBugs {
                    // version("${versions.spotbugs}")
                    useFbContrib(/* ${versions.fbContrib} */)
                    useFindSecBugs(/* ${versions.findSecBugs} */)
                }
            }
        }

        dependencyUpdates.enable()
        vulnerabilityScan.enable()
        lint.enable()
        codeAnalysis.enable()
        developmentMode.enable()

        test {
            prettyPrint(true)
            withIntegrationTests(true)
            withFunctionalTests(true)
            // withCustomTests("...")
            withJunitJupiter(/* "${versions.junit}" */)
            withJacoco(/* "${versions.jacoco}" */)
        }

        benchmark {
            // jmhVersion("${versions.jmh}")
        }

        packaging {
            uberJar {
                // minimize(false)
            }
        }

        docker {
            withJvmKill(/* "${versions.jvmKill}" */)
            // baseImage("bellsoft/liberica-openjdk-alpine:${versions.jvm}")
            // withAppSh(false)
            // ports.add()
            // javaOpts("")
        }

        documentation.enable()
    }
}
